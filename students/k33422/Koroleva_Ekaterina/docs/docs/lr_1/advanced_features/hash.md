# Механизм хеширования паролей с использованием bcrypt

## Введение

Для обеспечения безопасности пользовательских данных, важно надежно хранить пароли. В нашем
веб-приложении для этой цели используется библиотека `bcrypt`, которая позволяет надежно хешировать
и проверять пароли.

## Хеширование пароля

### Функция `hash_password`

- **Аргументы:**
    - `password` (str): Пароль, который необходимо захешировать.

- **Возвращает:**
    - Захешированный пароль в формате строки.

#### Процесс:

1. **Кодирование пароля:** Перед хешированием пароль преобразуется в байты.
2. **Генерация соли:** `bcrypt.gensalt()` генерирует уникальную "соль" для каждого хеширования, что
   делает каждый хеш уникальным даже для одинаковых паролей.
3. **Хеширование пароля с солью:** Соль добавляется к паролю, и результат хешируется.
4. **Возврат хеша:** Хеш возвращается в декодированном виде, чтобы его можно было сохранить в базе
   данных.

#### Пример кода:

```python
def hash_password(password: str) -> str:
    return bcrypt.hashpw(password.encode(), bcrypt.gensalt()).decode()
```

## Валидация пароля

### Функция `validate_password`

- **Аргументы:**
    - `password` (str): Пароль, введенный пользователем.
    - `hashed_password` (str): Хешированный пароль, сохраненный в базе данных.

- **Возвращает:**
    - `True`, если хеши совпадают.
    - `False`, если хеши не совпадают.

#### Процесс:

1. **Кодирование введенного пароля:** Введенный пароль кодируется в байты.
2. **Сравнение с хешированным паролем:** Используя функцию `bcrypt.checkpw`, введенный пароль
   сравнивается с сохраненным хешированным паролем.
3. **Возврат результата:** Возвращает `True`, если хеши совпадают, иначе `False`.

#### Пример кода:

```python
def validate_password(password: str, hashed_password: str) -> bool:
    return bcrypt.checkpw(password.encode(), hashed_password.encode())
```
